# ç§¯åˆ†ä¸ç§°å·ç³»ç»Ÿ - å®Œæ•´å®ç°æ€»ç»“

## ğŸ¯ ä½ çš„è®¾è®¡æ–¹æ¡ˆæ€»ç»“

### æ ¸å¿ƒæ€æƒ³
> **æ¸¸æˆç»“æŸåï¼Œå‰ç«¯å°†å¯¹å±€ç»“æœä¼ é€’ç»™åç«¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·idã€æ¸¸æˆåã€èƒœè´Ÿæƒ…å†µç­‰ã€‚åç«¯æ ¹æ®ç»“æœè¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ç©å®¶å„è‡ªæœ€æ–°çš„ç­‰çº§åˆ†ï¼Œå†æ ¹æ®ç§°å·æˆäºˆè§„åˆ™ç¡®å®šç§°å·ï¼Œå°†å¯¹åº”æ¸¸æˆçš„ç­‰çº§åˆ†åŠç§°å·å†™å…¥æ•°æ®åº“ï¼Œå¹¶åŒæ­¥è¿”å›ç»™å‰ç«¯è¿›è¡Œæ›´æ”¹å’Œæ¸²æŸ“ã€‚å‰ç«¯æ¸²æŸ“ç§°å·æ—¶ï¼Œæ ¹æ®Grade.jsçš„ç§°å·æ˜¾ç¤ºè§„åˆ™è¿›è¡Œæ˜¾ç¤ºï¼Œæ¯”å¦‚é¢œè‰²ã€ç‰¹æ•ˆç­‰ã€‚ç©å®¶æ¯æ¬¡ç™»å½•æœåŠ¡å™¨ï¼Œéƒ½ä»æœåŠ¡å™¨è¯»å–å…¶ä¿¡æ¯ï¼Œå†è®©å‰ç«¯è¿›è¡Œæ¸²æŸ“æ˜¾ç¤ºã€‚**

### å®ç°ç°çŠ¶

âœ… **å·²å®Œå…¨å®ç°çš„éƒ¨åˆ†**

1. **åç«¯ ELO ç³»ç»Ÿ** (server/src/gamecore/EloService.js)
   - âœ… åŠ¨æ€ K å€¼è®¡ç®—
   - âœ… é¢„æœŸèƒœç‡è®¡ç®—
   - âœ… ç§¯åˆ†å˜åŒ–è®¡ç®—
   - âœ… æ—¶é—´è¡°å‡ç³»ç»Ÿ
   - âœ… Mu Dynamic åŠ¨æ€å¹³è¡¡

2. **åç«¯ Grade ç³»ç»Ÿ** (server/src/games/chinesechess/grade/Grade.js)
   - âœ… 10 çº§ç§°å·ä½“ç³»å®Œæ•´
   - âœ… æ ¹æ®æ’åç™¾åˆ†æ¯”åˆ†é…ç§°å·
   - âœ… æ”¯æŒ updatePlayerTitles()ï¼ˆæ¸¸æˆç»“æŸç«‹å³æ›´æ–°ï¼‰
   - âœ… æ”¯æŒ updateAllPlayerTitles()ï¼ˆå®šæ—¶æ‰¹é‡æ›´æ–°ï¼‰
   - âœ… æ¯ä¸ªç­‰çº§æœ‰åç§°ã€ç­‰çº§æ•°ã€é¢œè‰²

3. **åç«¯æ¸¸æˆæµç¨‹é›†æˆ** (server/src/games/chinesechess/gamepagehierarchy/ChineseChessTable.js)
   - âœ… handleWin() é›†æˆ ELO + Grade
   - âœ… æ¸¸æˆç»“æŸåç«‹å³è®¡ç®— ELO
   - âœ… æ¸¸æˆç»“æŸåç«‹å³æ›´æ–°ç§°å·
   - âœ… æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“
   - âœ… åŒ…å«å®Œæ•´ç»“æœçš„ game_ended äº‹ä»¶å¹¿æ’­

4. **åç«¯ API æ”¹è¿›** (server/src/controllers/userController.js)
   - âœ… getUserProfile() å·²æ›´æ–°ï¼Œç°åœ¨è¿”å› gameStats
   - âœ… åŒ…å«æ¯ä¸ªæ¸¸æˆçš„ ratingã€titleã€titleRankã€titleColor
   - âœ… æ”¯æŒæ˜¾ç¤ºæˆ˜ç»©ç»Ÿè®¡

5. **æ•°æ®åº“æ¨¡å‹** 
   - âœ… UserGameStats åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
   - âœ… GameMeta æ”¯æŒ Mu Dynamic ç®¡ç†

6. **å‰ç«¯äº‹ä»¶ç›‘å¬** (client/src/games/chinesechess/gamepagehierarchy/ChineseChessTableClient.ts)
   - âœ… ç›‘å¬ game_ended äº‹ä»¶
   - âœ… handleGameEnded() å·²å®ç°

---

## ğŸ“ ä¸‰å¤§é˜¶æ®µçš„å®ç°è¯¦æƒ…

### ç¬¬ä¸€é˜¶æ®µï¼šæ¸¸æˆè¿›è¡Œä¸­ âœ…
**çŠ¶æ€**ï¼šå®Œå…¨å®ç°

- å‰ç«¯é€šè¿‡ Socket.IO å‘é€ç§»åŠ¨æŒ‡ä»¤
- åç«¯éªŒè¯ç§»åŠ¨åˆæ³•æ€§
- åç«¯å®æ—¶æ›´æ–°æ£‹ç›˜çŠ¶æ€
- å¹¿æ’­æ–°çŠ¶æ€ç»™åŒæ–¹ç©å®¶

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `ChineseChessTable.js` - æ¸¸æˆé€»è¾‘
- `ChineseChessTableClient.ts` - å‰ç«¯å¤„ç†

---

### ç¬¬äºŒé˜¶æ®µï¼šæ¸¸æˆç»“æŸ âœ…
**çŠ¶æ€**ï¼šå®Œå…¨å®ç°

**æµç¨‹**ï¼š

```javascript
1. æ¸¸æˆç»“æŸæ¡ä»¶è§¦å‘
   - è¢«å°†å†›
   - è¶…æ—¶
   - è®¤è¾“
   - å¯¹æ‰‹ç¦»çº¿

2. åç«¯ handleWin(winnerSide) æ‰§è¡Œ
   â”œâ”€ ELO è®¡ç®—ä¸ä¿å­˜
   â”‚  â””â”€ EloService.processMatchResult()
   â”‚     â”œâ”€ è®¡ç®— K å€¼
   â”‚     â”œâ”€ è®¡ç®—é¢„æœŸèƒœç‡
   â”‚     â”œâ”€ è®¡ç®—ç§¯åˆ†å˜åŒ–
   â”‚     â””â”€ æ›´æ–° UserGameStats.rating, wins, losses, gamesPlayed, lastPlayedAt
   â”‚
   â”œâ”€ ç§°å·æ›´æ–°ï¼ˆä»…ä¸­å›½è±¡æ£‹ï¼‰
   â”‚  â””â”€ Grade.updatePlayerTitles([winnerId, loserId], 'chinesechess')
   â”‚     â”œâ”€ è®¡ç®—æ–°æ’å
   â”‚     â”œâ”€ æŸ¥è¡¨è·å–æ–°ç§°å·
   â”‚     â””â”€ æ›´æ–° UserGameStats.title, titleRank, titleColor
   â”‚
   â”œâ”€ æ¸¸æˆè±†ç»“ç®—ï¼ˆåç»­å¼€å‘ï¼‰
   â”‚  â””â”€ this.settle() [å¾…å®ç°]
   â”‚
   â””â”€ å¹¿æ’­ game_ended äº‹ä»¶
      {
          result: {
              winner: 'r' | 'b',
              winnerId: string,
              elo: {
                  playerA: { oldRating, newRating, delta },
                  playerB: { oldRating, newRating, delta }
              },
              title: {
                  winnerId: { title, titleRank, titleColor },
                  loserId: { title, titleRank, titleColor }
              }
          }
      }

3. å‰ç«¯æ¥æ”¶äº‹ä»¶
   â””â”€ ChineseChessTableClient.handleGameEnded()
      â”œâ”€ æ›´æ–°æ¸¸æˆçŠ¶æ€ä¸º 'matching'
      â”œâ”€ æ˜¾ç¤ºæ¸¸æˆç»“æœå¯¹è¯æ¡†
      â”œâ”€ æ˜¾ç¤ºç§°å·å˜åŒ–
      â”œâ”€ æ˜¾ç¤ºç§¯åˆ†å˜åŒ–
      â””â”€ å¯åŠ¨å†æ¥ä¸€å±€å€’è®¡æ—¶
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `EloService.js` - ELO è®¡ç®—
- `Grade.js` - ç§°å·è®¡ç®—
- `ChineseChessTable.js` - æµç¨‹æ•´åˆ
- `MatchPlayers.js` - game_ended äº‹ä»¶å¹¿æ’­
- `ChineseChessTableClient.ts` - å‰ç«¯å¤„ç†

---

### ç¬¬ä¸‰é˜¶æ®µï¼šç™»å½• & æ•°æ®åŒæ­¥ âœ…
**çŠ¶æ€**ï¼šå®Œå…¨å®ç°

**æµç¨‹**ï¼š

```javascript
1. ç”¨æˆ·ç™»å½•
   POST /api/user/login
   â”œâ”€ éªŒè¯ç”¨æˆ·å‡­è¯ï¼ˆç”¨æˆ·å/å¯†ç æˆ– Pi IDï¼‰
   â”œâ”€ ç”Ÿæˆ JWT Token
   â””â”€ è¿”å› { token, userId, username }

2. å‰ç«¯ä¿å­˜ token å’Œ userId
   â””â”€ localStorage.setItem('token', token)
   â””â”€ localStorage.setItem('userId', userId)

3. è¿›å…¥ä¸ªäººä¸­å¿ƒ
   GET /api/user/profile?userId=abc123
   â”œâ”€ æŸ¥è¯¢ User è¡¨ â†’ åŸºæœ¬ä¿¡æ¯
   â”œâ”€ æŸ¥è¯¢ UserGameStats è¡¨ â†’ æ¸¸æˆç»Ÿè®¡
   â”‚  â””â”€ æ‰€æœ‰æ¸¸æˆçš„ rating, title, titleRank, titleColor, æˆ˜ç»©
   â”œâ”€ æŸ¥è¯¢ Wallet è¡¨ â†’ èµ„äº§
   â””â”€ è¿”å›å®Œæ•´ç”¨æˆ·ä¿¡æ¯
   {
       _id, username, nickname, avatar, assets,
       gameStats: {
           chinesechess: {
               rating: 1606,
               title: 'ä¸¾ä¸–æ— åŒ',
               titleRank: 10,
               titleColor: '#FF6200',
               gamesPlayed: 45,
               wins: 30,
               losses: 15,
               draws: 0,
               lastPlayedAt: ...
           }
       }
   }

4. å‰ç«¯æ¸²æŸ“ç”¨æˆ·ä¿¡æ¯
   â”œâ”€ åŸºæœ¬ä¿¡æ¯
   â”œâ”€ ä¸­å›½è±¡æ£‹ç§°å·ï¼ˆå¸¦é¢œè‰²ï¼‰
   â”œâ”€ ä¸­å›½è±¡æ£‹ç­‰çº§åˆ†
   â””â”€ æˆ˜ç»©ç»Ÿè®¡
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `userRoutes.js` - API è·¯ç”±
- `userController.js` - API é€»è¾‘ï¼ˆå·²æ›´æ–°ï¼‰
- `UserProfile.tsx` - å‰ç«¯æ¸²æŸ“ï¼ˆéœ€è¦é€‚é…æ–°æ•°æ®ç»“æ„ï¼‰

---

## ğŸ”§ éœ€è¦å‰ç«¯é€‚é…çš„éƒ¨åˆ†

### 1. æ¸¸æˆç»“æœæ˜¾ç¤ºå¯¹è¯æ¡†

å‰ç«¯éœ€è¦åˆ›å»ºæˆ–ä¼˜åŒ– `GameEndDialog` ç»„ä»¶æ¥æ˜¾ç¤ºï¼š

```tsx
interface GameResult {
    won: boolean;           // æ˜¯å¦è·èƒœ
    winner: 'r' | 'b';      // èƒœæ–¹
    winnerId: string;       // èƒœè€…ID
    oldRating: number;      // æ—§ç­‰çº§åˆ†
    newRating: number;      // æ–°ç­‰çº§åˆ†
    delta: number;          // ç§¯åˆ†å˜åŒ– (+/-)
    newTitle: string;       // æ–°ç§°å·åç§°
    newTitleColor: string;  // æ–°ç§°å·é¢œè‰²ï¼ˆhexï¼‰
    newTitleRank: number;   // æ–°ç§°å·ç­‰çº§ï¼ˆ1-10ï¼‰
}

// ç»„ä»¶éœ€è¦æ˜¾ç¤ºï¼š
<GameEndDialog>
    <div className={won ? 'victory' : 'defeat'}>
        {won ? 'æ­å–œè·èƒœï¼' : 'ä¸å¹¸å¤±è´¥'}
    </div>
    
    <div className="rating-change">
        <span>è€ç­‰çº§åˆ†ï¼š{oldRating}</span>
        <span className={delta > 0 ? 'up' : 'down'}>
            æ–°ç­‰çº§åˆ†ï¼š{newRating} ({delta > 0 ? '+' : ''}{delta})
        </span>
    </div>
    
    <div className="title-change" style={{ color: newTitleColor }}>
        <h3>ğŸ–ï¸ ç§°å·æå‡</h3>
        <p>æ‚¨çš„æ–°ç§°å·ï¼š{newTitle}</p>
    </div>
    
    <div className="rematch-countdown">
        <p>30 ç§’åå¼€å§‹å†æ¥ä¸€å±€...</p>
        <button>åŒæ„</button>
        <button>æ‹’ç»</button>
    </div>
</GameEndDialog>
```

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
- `ChineseChessTableClient.ts` - åœ¨ handleGameEnded() ä¸­è°ƒç”¨æ˜¾ç¤ºå‡½æ•°
- `GameEndDialog.tsx` - åˆ›å»ºæ­¤ç»„ä»¶ï¼ˆå¦‚æœªå­˜åœ¨ï¼‰æˆ–ä¼˜åŒ–ç°æœ‰é€»è¾‘

### 2. ä¸ªäººä¸­å¿ƒä¿¡æ¯æ˜¾ç¤º

å‰ç«¯éœ€è¦é€‚é…æ–°çš„ gameStats æ•°æ®ç»“æ„ï¼š

```tsx
// ä½¿ç”¨åç«¯è¿”å›çš„ gameStats
<div className="user-profile">
    <h1>{profile.nickname}</h1>
    
    {/* ä¸­å›½è±¡æ£‹æˆç»© */}
    <div className="chess-stats">
        <h3>ä¸­å›½è±¡æ£‹</h3>
        
        {/* ç§°å·æ˜¾ç¤º */}
        <div 
            className="title-badge"
            style={{ color: profile.gameStats?.chinesechess?.titleColor }}
        >
            <h4>{profile.gameStats?.chinesechess?.title}</h4>
            <span className="rank">#{profile.gameStats?.chinesechess?.titleRank}</span>
        </div>
        
        {/* ç­‰çº§åˆ†æ˜¾ç¤º */}
        <div className="rating">
            <p>ç­‰çº§åˆ†ï¼š{profile.gameStats?.chinesechess?.rating}</p>
        </div>
        
        {/* æˆ˜ç»©ç»Ÿè®¡ */}
        <div className="record">
            <p>æ€»å±€æ•°ï¼š{profile.gameStats?.chinesechess?.gamesPlayed}</p>
            <p>èƒœï¼š{profile.gameStats?.chinesechess?.wins}</p>
            <p>è´Ÿï¼š{profile.gameStats?.chinesechess?.losses}</p>
            <p>å¹³ï¼š{profile.gameStats?.chinesechess?.draws}</p>
        </div>
    </div>
</div>
```

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
- `UserProfile.tsx` - é€‚é… gameStats æ•°æ®ç»“æ„ï¼Œæ˜¾ç¤ºæ¯ä¸ªæ¸¸æˆçš„æ•°æ®

---

## ğŸ“Š ç§°å·è¡¨ï¼ˆç”¨äºå‰ç«¯æ˜¾ç¤ºï¼‰

```typescript
const TITLE_CONFIG = [
    { rank: 1, name: 'åˆå‡ºèŒ…åº', color: '#000000' },        // é»‘è‰²
    { rank: 2, name: 'å°è¯•ç‰›åˆ€', color: '#8f2d56' },        // ç´«çº¢
    { rank: 3, name: 'æ¸å…¥ä½³å¢ƒ', color: '#00FF00' },        // ç»¿è‰²
    { rank: 4, name: 'é”‹èŠ’æ¯•éœ²', color: '#0000FF' },        // è“è‰²
    { rank: 5, name: 'å‡ºç±»æ‹”èƒ', color: '#FF0000' },        // çº¢è‰²
    { rank: 6, name: 'ç‚‰ç«çº¯é’', color: '#00FFFF' },        // é’è‰²
    { rank: 7, name: 'åæ»¡æ±Ÿæ¹–', color: '#ffee32' },        // é»„è‰²
    { rank: 8, name: 'å‚²è§†ç¾¤é›„', color: '#800080' },        // ç´«è‰²
    { rank: 9, name: 'ç™»å³°é€ æ', color: '#ffba08' },        // æ©™è‰²
    { rank: 10, name: 'ä¸¾ä¸–æ— åŒ', color: '#FF6200' }        // æ©™çº¢
];

// å‰ç«¯å¯ä»¥åˆ›å»ºè¾…åŠ©å‡½æ•°
export function getTitleColor(titleRank: number): string {
    const config = TITLE_CONFIG.find(t => t.rank === titleRank);
    return config?.color || '#000000';
}

export function getTitleName(titleRank: number): string {
    const config = TITLE_CONFIG.find(t => t.rank === titleRank);
    return config?.name || 'åˆå‡ºèŒ…åº';
}
```

---

## âœ… å®Œæ•´æ£€æŸ¥æ¸…å•

### åç«¯ (100% å®Œæˆ)
- [x] ELO è®¡ç®—ç³»ç»Ÿï¼ˆEloService.jsï¼‰
- [x] Grade ç§°å·ç³»ç»Ÿï¼ˆGrade.jsï¼‰
- [x] æ¸¸æˆæµç¨‹é›†æˆï¼ˆChineseChessTable.jsï¼‰
- [x] Socket.IO äº‹ä»¶å¹¿æ’­ï¼ˆgame_endedï¼‰
- [x] API ç«¯ç‚¹ä¼˜åŒ–ï¼ˆgetUserProfile è¿”å› gameStatsï¼‰
- [x] æ•°æ®åº“å­—æ®µé½å…¨ï¼ˆUserGameStatsï¼‰
- [x] æ—¶é—´è¡°å‡å’Œ Mu Dynamicï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰

### å‰ç«¯ (70% å®Œæˆ)
- [x] äº‹ä»¶ç›‘å¬å®ç°ï¼ˆgame_endedï¼‰
- [x] åŸºç¡€å¤„ç†é€»è¾‘ï¼ˆhandleGameEndedï¼‰
- [ ] **æ¸¸æˆç»“æœå¯¹è¯æ¡†**ï¼ˆéœ€è¦å®Œå–„ï¼‰
- [ ] **ä¸ªäººä¸­å¿ƒæ˜¾ç¤º**ï¼ˆéœ€è¦é€‚é…æ–°æ•°æ®ç»“æ„ï¼‰
- [ ] ç§°å·é¢œè‰²ç‰¹æ•ˆï¼ˆéœ€è¦å‰ç«¯è®¾è®¡ï¼‰

### æ•°æ®åº“ (100% å®Œæˆ)
- [x] User è¡¨ç»“æ„
- [x] UserGameStats è¡¨ç»“æ„
- [x] Wallet è¡¨ç»“æ„
- [x] GameMeta è¡¨ç»“æ„
- [x] Transaction è¡¨ç»“æ„

---

## ğŸš€ ç«‹å³å¯ç”¨çš„åŠŸèƒ½

### ç°åœ¨å°±èƒ½å·¥ä½œçš„ï¼š
1. âœ… æ¸¸æˆç»“æŸåè‡ªåŠ¨è®¡ç®— ELO
2. âœ… æ¸¸æˆç»“æŸåè‡ªåŠ¨è®¡ç®—ç§°å·
3. âœ… åç«¯è¿”å›å®Œæ•´çš„ game_ended äº‹ä»¶
4. âœ… åç«¯ API è¿”å›ç”¨æˆ·çš„å®Œæ•´æ¸¸æˆæ•°æ®
5. âœ… æ•°æ®åº“æ­£ç¡®ä¿å­˜æ‰€æœ‰ä¿¡æ¯

### éœ€è¦å‰ç«¯å®Œæˆçš„ï¼š
1. âŒ ç¾åŒ–æ¸¸æˆç»“æœå¯¹è¯æ¡†ï¼ˆæ˜¾ç¤ºç§°å·å˜åŒ–å’Œç§¯åˆ†å˜åŒ–ï¼‰
2. âŒ ä¼˜åŒ–ä¸ªäººä¸­å¿ƒï¼Œæ˜¾ç¤ºæ–°çš„ gameStats æ•°æ®
3. âŒ æ·»åŠ ç§°å·é¢œè‰²å’Œç‰¹æ•ˆ

---

## ğŸ“ å…³é”®æ¦‚å¿µæ€»ç»“

### ELO ç³»ç»Ÿï¼ˆé€šç”¨äºæ‰€æœ‰æ¸¸æˆï¼‰
- **K å€¼**ï¼šåŠ¨æ€ç³»æ•°ï¼Œæ ¹æ®å±€æ•°å’Œè¯„åˆ†å·®å†³å®š
- **Expected Score**ï¼šé¢„æœŸèƒœç‡ï¼Œå·®è·å¤§æ—¶æœŸæœ›å€¼å·®å¼‚å¤§
- **Delta**ï¼šç§¯åˆ†å˜åŒ–ï¼ŒK * (å®é™… - æœŸæœ›)
- **æ—¶é—´è¡°å‡**ï¼š7 å¤©æœªç©ï¼Œæ‰£é™¤ 0.01 * (rating - 1600)
- **Mu Dynamic**ï¼šæ¯æ—¥ 11:00 è®¡ç®—å¹³å‡è¯„åˆ†ï¼Œ12:00 ç”Ÿæ•ˆ

### Grade ç³»ç»Ÿï¼ˆä»…ä¸­å›½è±¡æ£‹ï¼‰
- **æ’å**ï¼šæ ¹æ® rating å¤§å°æ’åï¼Œä» 1 å¼€å§‹
- **ç™¾åˆ†æ¯”**ï¼š(rank - 1) / totalPlayers
- **ç§°å·**ï¼šæŒ‰ç™¾åˆ†æ¯”æŸ¥è¡¨ï¼Œ10 ä¸ªç­‰çº§
- **é¢œè‰²**ï¼šæ¯ä¸ªç­‰çº§éƒ½æœ‰å¯¹åº”é¢œè‰²ï¼Œç”¨äº UI æ˜¾ç¤º
- **æ›´æ–°æ—¶æœº**ï¼šæ¸¸æˆç»“æŸç«‹å³æ›´æ–°ï¼ˆåŒæ­¥ï¼‰ï¼Œæ¯å¤©å®šæ—¶æ‰¹é‡æ›´æ–°

### æ•°æ®åŒæ­¥
- **å®æ—¶åŒæ­¥**ï¼šæ¸¸æˆç»“æŸå³åˆ»è¿”å›æ–°æ•°æ®ç»™å‰ç«¯
- **ç™»å½•åŒæ­¥**ï¼šç”¨æˆ·ç™»å½•æ—¶ä»æœåŠ¡å™¨è¯»å–æœ€æ–°æ•°æ®
- **è¢«åŠ¨æ›´æ–°**ï¼šå®šæ—¶ cron ä»»åŠ¡ï¼ˆELO æ—¶é—´è¡°å‡å’Œ Mu Dynamicï¼‰

---

## ğŸ“ å¸¸è§é—®é¢˜ Q&A

**Q: ä¸ºä»€ä¹ˆ Grade åªç”¨äºä¸­å›½è±¡æ£‹ï¼Œä¸ç”¨äºå…¶ä»–æ¸¸æˆï¼Ÿ**
A: å› ä¸ºç§°å·ç³»ç»Ÿæ˜¯æ¸¸æˆç‰¹å®šçš„ï¼Œä¸åŒæ¸¸æˆå¯èƒ½æœ‰ä¸åŒçš„ç­‰çº§è§„åˆ™ã€‚ELO æ˜¯é€šç”¨çš„ç§¯åˆ†ç³»ç»Ÿï¼ŒGrade æ˜¯æ¸¸æˆç‰¹å®šçš„ç§°å·ç³»ç»Ÿã€‚

**Q: ç§¯åˆ†å˜ä¸ºè´Ÿæ•°æ€ä¹ˆåŠï¼Ÿ**
A: ç†è®ºä¸Šä¸ä¼šï¼Œå› ä¸ºäººäººéƒ½æœ‰åŸºç¡€åˆ†ã€‚ä½†å¦‚æœéœ€è¦ä¸‹é™ï¼Œå¯åœ¨ EloService ä¸­æ·»åŠ æ£€æŸ¥ã€‚

**Q: å¦‚æœä¸¤ä¸ªç©å®¶è¯„åˆ†å®Œå…¨ç›¸åŒï¼Ÿ**
A: Grade ä¼šæ ¹æ®ç©å®¶çš„åŠ å…¥é¡ºåºæ’åï¼Œæ•°æ®åº“ä¸­åº”è¯¥æœ‰ unique indexã€‚

**Q: ç§°å·æ›´æ–°éœ€è¦å¤šä¹…ï¼Ÿ**
A: æ¸¸æˆç»“æŸåç«‹å³æ›´æ–°ï¼ˆåŒæ­¥æ“ä½œï¼‰ï¼Œæ— éœ€ç­‰å¾…ã€‚

**Q: å‰ç«¯å¦‚ä½•æ˜¾ç¤ºç§°å·çš„ç‰¹æ•ˆï¼Ÿ**
A: ä½¿ç”¨åç«¯è¿”å›çš„ titleColorï¼Œå¯ä»¥åŠ  text-shadowã€background ç­‰ CSS ç‰¹æ•ˆã€‚

**Q: ä¸ºä»€ä¹ˆæœ‰ eloCron.js å’Œ Grade ä¸¤ä¸ªç³»ç»Ÿï¼Ÿ**
A: eloCron æ˜¯å…¨å±€çš„ ELO è®¡ç®—ä»»åŠ¡ï¼ˆæ‰€æœ‰æ¸¸æˆï¼‰ï¼ŒGrade æ˜¯æ¸¸æˆç»“æŸæ—¶çš„ç§°å·æ›´æ–°ï¼ˆä»…ä¸­å›½è±¡æ£‹ï¼‰ã€‚

---

## ğŸ“š å…³é”®æ–‡ä»¶å¯¼èˆª

### åç«¯
```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ gamecore/
â”‚   â”‚   â””â”€â”€ EloService.js ..................... ELO è®¡ç®—ç³»ç»Ÿ
â”‚   â”‚
â”‚   â”œâ”€â”€ games/chinesechess/
â”‚   â”‚   â”œâ”€â”€ grade/
â”‚   â”‚   â”‚   â””â”€â”€ Grade.js ..................... ç§°å·ç³»ç»Ÿ
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ gamepagehierarchy/
â”‚   â”‚       â””â”€â”€ ChineseChessTable.js ........ æ¸¸æˆæµç¨‹æ•´åˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ userController.js ............... API é€»è¾‘ï¼ˆå·²æ›´æ–°ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ UserGameStats.js ............... æ¸¸æˆç»Ÿè®¡è¡¨
â”‚   â”‚   â”œâ”€â”€ GameMeta.js .................... æ¸¸æˆå…ƒæ•°æ®è¡¨
â”‚   â”‚   â””â”€â”€ User.js ....................... ç”¨æˆ·è¡¨
â”‚   â”‚
â”‚   â”œâ”€â”€ cron/
â”‚   â”‚   â””â”€â”€ eloCron.js .................... å®šæ—¶ä»»åŠ¡
â”‚   â”‚
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ userRoutes.js ................. ç”¨æˆ· API è·¯ç”±
â”‚
â””â”€â”€ package.json
```

### å‰ç«¯
```
client/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ games/chinesechess/gamepagehierarchy/
â”‚   â”‚   â”œâ”€â”€ ChineseChessTableClient.ts ..... æ¸¸æˆå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ ChineseChessTableView.tsx .... æ¸¸æˆè§†å›¾
â”‚   â”‚
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ game/chinesechess/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx .................. æ¸¸æˆé¡µé¢
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ profile/
â”‚   â”‚       â”œâ”€â”€ page.tsx ................. ä¸ªäººä¸­å¿ƒé¡µé¢
â”‚   â”‚       â””â”€â”€ UserProfile.tsx ......... ä¸ªäººä¸­å¿ƒç»„ä»¶ï¼ˆéœ€æ›´æ–°ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ GameEndDialog.tsx ............ æ¸¸æˆç»“æœå¯¹è¯æ¡†ï¼ˆéœ€åˆ›å»º/ä¼˜åŒ–ï¼‰
â”‚
â””â”€â”€ package.json
```

---

## æ€»ç»“

ä½ çš„è®¾è®¡å®Œå…¨ç¬¦åˆæœ€ä½³å®è·µï¼š
1. âœ… **å‰åç«¯åˆ†ç¦»**ï¼šå‰ç«¯åªç®¡æ˜¾ç¤ºï¼Œåç«¯è´Ÿè´£è®¡ç®—
2. âœ… **å®æ—¶åé¦ˆ**ï¼šæ¸¸æˆç»“æŸç«‹å³è¿”å›ç»“æœï¼Œæ— éœ€è½®è¯¢
3. âœ… **æ•°æ®ä¸€è‡´æ€§**ï¼šæ•°æ®åº“æ˜¯å”¯ä¸€çœŸå®æ¥æºï¼Œç™»å½•æ—¶é‡æ–°åŒæ­¥
4. âœ… **ç³»ç»Ÿç‹¬ç«‹**ï¼šELO å’Œ Grade ç³»ç»Ÿå®Œå…¨åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤æ‰©å±•

**åç«¯å®ç° 100% å®Œæˆï¼Œå‰ç«¯åªéœ€é€‚é…æ•°æ®æ˜¾ç¤ºå³å¯ï¼** ğŸ‰

